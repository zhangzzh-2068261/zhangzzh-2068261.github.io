window.uc = window.uc || {};

(function($){
    window.uc.dialog = function( args ){
        if ( typeof args.autoOpen == 'undefined' ){
            args.autoOpen = true;
        }

        buttons = '';

        if ( typeof args.buttons != 'undefined' ){
            for ( button in args.buttons ) {
                action = args.buttons[ button ];
                if ( typeof action == 'function' ){
                    buttons += '<button data-action="func" class=" modal-action waves-effect waves-green btn-flat">' + button + '</button>';
                } else if ( action == 'close' ) {
                    buttons += '<button data-action="close" class=" modal-action waves-effect waves-green btn-flat">' + button + '</button>';
                } else {
                    buttons += '<a href="' + action + '" class=" modal-action waves-effect waves-green btn-flat">' + button + '</a>';
                }
            }
        } else {
            buttons = '<button data-action="close" class=" modal-action waves-effect waves-green btn-flat">Close</button>';
        }

        if ( buttons )
            buttons = '<div class="modal-footer">' + buttons + '</div>';

        html = 
        '<div class="modal">\
            <div class="modal-content">\
                <h4>' + args.title + '<span class="dashicons dashicons-no right modal-action" data-action="close" style="cursor: pointer;"></span></h4>\
                <p style="margin: 0;">' + args.content + '</p>\
            </div>\
            '+ buttons + '\
        </div>';

        var modal = $(html);
        $('body').append( modal );
        modal.args = args;
        modal.modal(
            {
                complete: function() { modal.remove(); }
            }
        );

        modal.on('click', '.modal-action', function(){
            switch ( $(this).data('action') ){
                case 'close':
                    modal.modal('close');
                    break;
                case 'func':
                    modal.args.buttons[ $(this).text() ]();
                    break;
            }
        });

        if ( args.autoOpen ) {
            modal.modal('open');
        }

        return modal;
    }
})(jQuery)
